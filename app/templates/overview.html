{% extends "base.html" %}

{% block content %}
<div class="main-content">
    <!-- Hero Section -->
    <section class="hero-section">
        <h1>–ù–∞–π–¥–∏—Ç–µ –∏–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–µ–ª—å –¥–ª—è –≤–∞—à–µ–≥–æ –æ—Ç–¥—ã—Ö–∞</h1>
        <p>–ë—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –æ—Ç–µ–ª–∏ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –ª—É—á—à–µ–π —Ü–µ–Ω—ã</p>
        
        <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Ñ–æ—Ä–º–∞ -->
        <div class="search-form">
            <div class="form-grid">
                <div class="form-group">
                    <label for="destination" class="form-label">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</label>
                    <input type="text" id="destination" class="form-input" placeholder="–ö—É–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–µ—Ö–∞—Ç—å?">
                </div>
                
                <div class="form-group">
                    <label for="checkin" class="form-label">–ó–∞–µ–∑–¥</label>
                    <input type="date" id="checkin" class="form-input">
                </div>
                
                <div class="form-group">
                    <label for="checkout" class="form-label">–í—ã–µ–∑–¥</label>
                    <input type="date" id="checkout" class="form-input">
                </div>
                
                <div class="form-group">
                    <label for="guests" class="form-label">–ì–æ—Å—Ç–∏</label>
                    <select id="guests" class="form-select">
                        <option value="1">1 –≥–æ—Å—Ç—å</option>
                        <option value="2" selected>2 –≥–æ—Å—Ç—è</option>
                        <option value="3">3 –≥–æ—Å—Ç—è</option>
                        <option value="4">4 –≥–æ—Å—Ç—è</option>
                    </select>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="searchHotels()">
                <span>üîç –ù–∞–π—Ç–∏ –æ—Ç–µ–ª–∏</span>
            </button>
        </div>
    </section>

    <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <section class="section">
        <h2 class="section-title">üéØ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h2>
        <div class="filters-section">
            <div class="filter-options">
                <div class="filter-option active" onclick="filterByCity('')">–í—Å–µ –≥–æ—Ä–æ–¥–∞</div>
                {% for city in aggregates.cities %}
                <div class="filter-option" onclick="filterByCity('{{ city }}')">{{ city }}</div>
                {% endfor %}
            </div>
        </div>
        
        <div class="hotels-grid" id="hotelsGrid">
            {% for hotel in hotels %}
            <div class="hotel-card fade-in" data-city="{{ hotel.city }}">
                <div class="hotel-image">
                    üè®
                </div>
                <div class="hotel-content">
                    <div class="hotel-header">
                        <div>
                            <h3 class="hotel-name">{{ hotel.name }}</h3>
                            <div class="hotel-location">
                                <span>üìç {{ hotel.city }}</span>
                                <span class="hotel-stars">{{ '‚≠ê' * hotel.stars }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <p class="hotel-description">{{ hotel.description }}</p>
                    
                    <div class="hotel-features">
                        {% for feature in hotel.features[:4] %}
                        <span class="feature-tag">{{ feature }}</span>
                        {% endfor %}
                    </div>
                    
                    <div class="hotel-price">
                        <div>
                            <div class="price-amount">$150</div>
                            <div class="price-period">–∑–∞ –Ω–æ—á—å</div>
                        </div>
                        <button class="btn btn-primary" onclick="viewHotel('{{ hotel.id }}')">
                            –í—ã–±—Ä–∞—Ç—å –Ω–æ–º–µ—Ä
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <section class="section">
        <h2 class="section-title">üìä –ù–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-value">{{ aggregates.hotel_count }}</div>
                <div class="metric-label">–û—Ç–µ–ª–µ–π</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">{{ aggregates.room_count }}</div>
                <div class="metric-label">–ù–æ–º–µ—Ä–æ–≤</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">{{ aggregates.cities|length }}</div>
                <div class="metric-label">–ì–æ—Ä–æ–¥–æ–≤</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">98%</div>
                <div class="metric-label">–î–æ–≤–æ–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
            </div>
        </div>
    </section>

    <!-- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ -->
    <section class="section">
        <h2 class="section-title">‚ö° –£–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">üèÉ</div>
                <h3>–õ–µ–Ω–∏–≤—ã–π –ø–æ–∏—Å–∫</h3>
                <p>–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –±–µ–∑ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–µ–Ω–∏–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">‚ö°</div>
                <h3>FRP —Å–æ–±—ã—Ç–∏—è</h3>
                <p>–†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üéº</div>
                <h3>–ö–æ–º–ø–æ–∑–∏—Ü–∏—è</h3>
                <p>–ì–∏–±–∫–∏–µ —Ü–µ–ø–æ—á–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –∫–æ–º–ø–æ–∑–∏—Ü–∏—é</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üöÄ</div>
                <h3>–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å</h3>
                <p>–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏</p>
            </div>
        </div>
    </section>
</div>

<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—Ç
document.addEventListener('DOMContentLoaded', function() {
    const today = new Date();
    const nextWeek = new Date(today);
    nextWeek.setDate(nextWeek.getDate() + 3);
    
    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç –¥–ª—è input type="date"
    const formatDate = (date) => date.toISOString().split('T')[0];
    
    document.getElementById('checkin').value = formatDate(today);
    document.getElementById('checkout').value = formatDate(nextWeek);
});

function searchHotels() {
    const destination = document.getElementById('destination').value;
    const checkin = document.getElementById('checkin').value;
    const checkout = document.getElementById('checkout').value;
    const guests = document.getElementById('guests').value;

    if (!destination) {
        showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', 'warning');
        return;
    }

    showAlert('–ò—â–µ–º –ª—É—á—à–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –≤–∞—Å...', 'info');
    
    // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
    setTimeout(() => {
        showAlert(`–ù–∞–π–¥–µ–Ω—ã –æ—Ç–µ–ª–∏ –≤ ${destination} –¥–ª—è ${guests} –≥–æ—Å—Ç–µ–π`, 'success');
        
        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Ç–µ–ª–µ–π –ø–æ –≥–æ—Ä–æ–¥—É
        filterByCity(destination);
    }, 1500);
}

function filterByCity(city) {
    const hotels = document.querySelectorAll('.hotel-card');
    const filterButtons = document.querySelectorAll('.filter-option');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —Ñ–∏–ª—å—Ç—Ä–∞
    filterButtons.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    let visibleCount = 0;
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –æ—Ç–µ–ª–∏
    hotels.forEach(hotel => {
        if (!city || hotel.dataset.city.toLowerCase().includes(city.toLowerCase())) {
            hotel.style.display = 'block';
            visibleCount++;
        } else {
            hotel.style.display = 'none';
        }
    });
    
    if (visibleCount === 0) {
        showAlert('–û—Ç–µ–ª–µ–π –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –≥–æ—Ä–æ–¥–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ', 'warning');
    }
}

function viewHotel(hotelId) {
    showAlert(`–û—Ç–∫—Ä—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏ –æ—Ç–µ–ª—è...`, 'info');
    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ç–µ–ª—è
    setTimeout(() => {
        window.location.href = `/hotels#${hotelId}`;
    }, 1000);
}

function showAlert(message, type) {
    // –£–¥–∞–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    const existingAlerts = document.querySelectorAll('.custom-alert');
    existingAlerts.forEach(alert => alert.remove());
    
    const alert = document.createElement('div');
    alert.className = `custom-alert alert-${type}`;
    alert.innerHTML = `
        <div class="alert-content">
            <span>${message}</span>
            <button onclick="this.parentElement.parentElement.remove()">√ó</button>
        </div>
    `;
    
    document.body.appendChild(alert);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
        if (alert.parentElement) {
            alert.remove();
        }
    }, 5000);
}
</script>

<style>
.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;
}

.feature-card {
    background: white;
    padding: 1.5rem;
    border-radius: 12px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    transition: transform 0.3s ease;
}

.feature-card:hover {
    transform: translateY(-5px);
}

.feature-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
}

.feature-card h3 {
    color: var(--dark-slate);
    margin-bottom: 0.5rem;
}

.feature-card p {
    color: var(--text-light);
    line-height: 1.5;
}

.custom-alert {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    max-width: 400px;
    animation: slideInRight 0.3s ease-out;
}

.alert-content {
    background: white;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
}

.alert-content button {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: #666;
}

.alert-success .alert-content {
    border-left: 4px solid var(--olive-drab);
}

.alert-warning .alert-content {
    border-left: 4px solid #FF9800;
}

.alert-info .alert-content {
    border-left: 4px solid var(--sky-blue);
}

@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.cart-link {
    background: var(--olive-drab) !important;
}
</style>
{% endblock %}